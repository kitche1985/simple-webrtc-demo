# simple-webrtc-demo 一个简单的WebRTC演示程序

整体流程：
用户注册、登录、添加好友。
用户登录后需通过系统WebSocket向系统注册在线信息，如果系统WebSocket断开，则用户离线。
用户状态存在以下几种：在线、离线、通话连接中、通话中、通话结束中。

> 用户A获取摄像头和麦克风权限后才可以发起会话。
> 用户A通过系统WebSocket向好友B发起通话请求，在线好友B客户端的系统WebSocket就会获取推送并处理通话请求。
> 此时用户A的状态设置为通话连接中，而且不能发起或被邀请进入一个新的会话。
> 在好友B通过通话请求邀请后，用户A通过getUserMedia()获取录制流，使用Simple-peer将流封装并生成一个P2P的peer，通过WebSocket递交给好友B。
> 在建立完成前用户A和好友B的用户状态均改为通话中并通知给所有他们的好友，使其无法再次主叫或被叫。
> 在双方任意一方结束这个会话时，或者在会话创建失败时，将根据用户的系统WebSocket在离线状态重新设置用户状态，并通知给他们的好友。

简化后的计划：

    一、简化登录流程，直接在应用主页面输入用户名，并且通知全部连接到WebSocket的用户。（上线通知）
    二、所有用户均可以呼叫其他在线用户。无法看到离线用户。
    三、用户token为时间戳。

简化后的用户信息为：
    
    用户名、token、用户状态。

需要的准备：

    server: node / socket.io
    client: app / simple-peer 
            webapp / angular 

